# phase2

# 최적화 모델 개선 보고서 (Feedback & Improvement)

### 개요
- **목표**: 초기 코드(`FAST SCM Solver`)의 문제점을 진단하고, 최종 코드(`Hybrid SCM Solver`)에서 어떻게 개선되었는지 기술적으로 설명합니다.
- **핵심 개선 방향**: 단일 통합 모델(Monolithic)의 한계를 극복하기 위해, **전략(MIP)과 운영(LP)을 분리**하는 하이브리드 구조로 전면 재설계했습니다.

---

### 상세 개선 내역

| 구분 | 문제점 (Issue) | 현상 (Symptom) | 개선 방안 (Solution) |
| :--- | :--- | :--- | :--- |
| **구조** | **전략/운영 통합 모델**<br/>- 매월 설비 위치(전략)와 생산/운송(운영)을 동시에 최적화 시도. | - **계산 복잡성 폭증**<br/>- 모델이 너무 거대하고 복잡하여 해를 찾지 못하거나 비현실적인 결과를 도출. | **하이브리드 모델 도입**<br/>1. **MIP**로 설비 위치(전략)를 **최초 1회만** 결정.<br/>2. 결정된 설비를 바탕으로 **LP**를 통해 월별 운영 계획을 순차적으로 최적화. |
| **실행** | **LP Relaxation 오류**<br/>- "Yes or No" 결정(설비 건설)을 0~1 사이 실수로 가정. | - **실행 불가능한 해**<br/>- "공장을 0.7개 건설"과 같이 현실에서 불가능한 해를 생성.<br/>- 단순 반올림 시 제약조건 위반으로 모델이 **Infeasible(실행불가)** 상태가 됨. | **정수 변수 최적화(MIP)**<br/>- 설비 건설 변수(`x_fac`, `x_wh`)를 `GRB.BINARY`로 선언.<br/>- 반드시 0(미건설) 또는 1(건설)의 값을 갖도록 하여 현실적인 해를 보장. |
| **논리** | **비현실적 목표 함수**<br/>- 수요 미충족에 대한 페널티 부재.<br/>- `공장 -> 창고` 물류 흐름 누락. | - **비논리적인 해**<br/>- **(V1)** "아무것도 건설하지 않는 것"이 최적해로 도출됨 (비용 $0).<br/>- **(V2)** "공장 없이 창고만 건설"하는 해 도출. | **현실적 목표 함수 설계**<br/>- 수요 미충족 시 막대한 페널티(`PENALTY_UNMET`)를 부과.<br/>- `공장->창고->도시`로 이어지는 **전체 물류 흐름과 비용을 명시적으로 반영.** |
| **연결성** | **Rolling Horizon 단절**<br/>- 월별 계획 시, 이전 달에서 넘어오는 '운송 중 재고'를 미반영. | - **결과 없음 (`Total rows: 0`)**<br/>- 매달 재고가 0에서 시작하는 것으로 간주되어, 리드타임 초반의 수요를 절대 충족시킬 수 없음.<br/>- 모델이 "아무것도 생산/운송하지 않는 것"이 최선이라고 판단. | **`in-transit_carryover` 구현**<br/>- 각 월의 마지막에, 다음 달에 도착할 운송량을 계산.<br/>- 이 값을 다음 달 계획의 **'초기 입고 예정량'**으로 전달하여 모든 기간을 논리적으로 연결. |

---

### 최종 결론

- **From**: 모든 것을 한 번에 풀려는 비효율적이고 불안정한 **단일 통합 모델 (Monolithic Model)**
- **To**: **전략과 운영을 분리**하고 각 단계의 논리적 허점을 보완하여, 안정적이고 실행 가능한 솔루션을 도출하는 **하이브리드 모델 (Hybrid Model)**로 성공적으로 전환함.
